---
title: Django 笔记：CentOS+Apache+mod_wsgi+Django 
date: 2020/02/03
categories: 软件使用
tags: [Django, Mariadb, Python]
---

<!-- toc -->

<!-- more -->

# 工具安装和环境配

## 系统环境

- 系统：CentOS Linux release 7.7.1908 (Core)
- Mariadb 版本：mysql  Ver 15.1 Distrib 5.5.64-MariaDB, for Linux (x86_64) using readline 5.1
- Apache 版本：Apache/2.4.6 (CentOS)

## 安装工具

### 安装虚拟环境

```shell
pip3 install virtualenv
```

### 安装 Django

```shell
pip3 install django
```

我安装的 Django 版本为： 3.0.2



# 初始化

# 诗经应用

采用 github 上的诗词数据库 https://github.com/chinese-poetry/chinese-poetry 中的诗经数据。

将 json 数据保存到数据库中

```python
'''将 json 转换到数据库'''
# https://shockerli.net/post/python3-pymysql/

import json
import pymysql

import os
print(os.getcwd())

# 连接数据库。假设数据库中已经建好了名为 poetry 的空数据库。
poetry = pymysql.connect(host='localhost',
                         port=3306,
                         user='root',
                         password='×××',
                         db='poetry')
cursor = poetry.cursor()




# 转存《诗经》。
# 读取 shijing.json 到变量 shijing 中。
with open('./shijing.json') as f:
    shijing = json.load(f)

# 查看 shijing.json 中有哪些 key
# for k in shijing[0].keys():
#     print(k)

# 为 shijing 创建一个表。
# cursor.execute('''
#                create table shijing(id int not null auto_increment,
#                                     title varchar(32) not null,
#                                     chapter varchar(32) not null,
#                                     section varchar(32) not null,
#                                     content varchar(8000) not null,
#                                     primary key (id)
#                                    )
#                ''')


# 将数组写入数据库。
shijing_sql = ('insert into poetry_shijing (title, chapter, section, content)'
               + 'values (%s, %s, %s, %s)')
shijing_values = [list(v.values()) for v in shijing]  # 将字典转换为数组
for v in shijing_values:                              # 将数组转换为字符串
    v[3] = '\n'.join(v[3])
    
cursor.executemany(shijing_sql, shijing_values[:])  # 写入数据库
poetry.commit()                                      # 提交更改

```



# 未完



# 参考资料

https://docs.djangoproject.com/zh-hans/3.0/intro/tutorial01/