{"md5":"e140c9bf93aa9d891b73b710322c04f6","content":"<div id=\"content\">\n<!-- toc -->\n<!-- more -->\n\n<div id=\"outline-container-orga20d18e\" class=\"outline-2\">\n<h2 id=\"orga20d18e\">Model &#x90E8;&#x5206;</h2>\n<div class=\"outline-text-2\" id=\"text-orga20d18e\">\n<p>\nHamiltonian &#x4E3A;\n</p>\n\\begin{align*}\n  H =&amp; \\sum_{k,\\sigma}\\varepsilon_{k,\\sigma} a_{k,\\sigma}^{\\dagger} a_{k,\\sigma}\n  + \\sum_k (\\varepsilon_{k,b}+\\delta)b_k^{\\dagger}b_k  \\\\\n  &amp; + \\frac{\\lambda}{\\sqrt{\\Omega}} \\sum_{p,q}(b_{p+q}^{\\dagger}a_{p,1}a_{q,2}+\\mathrm{H.c.})\n\\end{align*}\n<p>\n&#x524D;&#x4E24;&#x9879;&#x662F;&#x539F;&#x5B50;&#x548C;&#x5206;&#x5B50;&#x6001;&#x7684;&#x80FD;&#x91CF;, &#x6700;&#x540E;&#x4E00;&#x9879;&#x662F;&#x6001; 1, 2 &#x548C;&#x5206;&#x5B50;&#x6001;&#x4E4B;&#x95F4;&#x7684;&#x8026;&#x5408;&#x9879;. &#x5176;&#x4E2D;\n</p>\n\\begin{align*}\n  \\varepsilon_{k,\\sigma} =&amp; \\frac{\\hbar^2 k^2}{2m} - \\mu_{\\sigma} \\\\\n  \\varepsilon_{k,b} =&amp; \\frac{\\hbar^2 k^2}{4m} - \\mu_1 -\\mu_2 \\\\\n  \\mu_1 =&amp; \\mu_3 = \\mu ,\\quad \\mu_2 =0\n\\end{align*}\n<p>\n&#x5C06;&#x8026;&#x5408;&#x90E8;&#x5206;&#x7B80;&#x8BB0;&#x4E3A;\n</p>\n\\begin{align*}\n  \\Lambda = \\sum_{p,q}(b_{p+q}^{\\dagger}a_{p,1}a_{q,2}+\\mathrm{H.c.})\n\\end{align*}\n\n<p>\n&#x5FAE;&#x6270;&#x4E3A;\n</p>\n\\begin{align*}\n  V = \\sum_k(a_{k,2}^{\\dagger}a_{k,3} e^{-\\mathrm{i} \\omega&apos;t}+a_{k,3}^{\\dagger}a_{k,2}e^{\\mathrm{i}\\omega&apos;t})\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-org7aefbd0\" class=\"outline-2\">\n<h2 id=\"org7aefbd0\">Sum rules &#x90E8;&#x5206;</h2>\n<div class=\"outline-text-2\" id=\"text-org7aefbd0\">\n</div>\n<div id=\"outline-container-org4b751e5\" class=\"outline-3\">\n<h3 id=\"org4b751e5\">&#x5047;&#x8BBE;</h3>\n<div class=\"outline-text-3\" id=\"text-org4b751e5\">\n<p>\n&#x5047;&#x8BBE;&#x7CFB;&#x7EDF;&#x7684;&#x57FA;&#x6001;&#x4E3A; 1 &#x548C; 3 &#x6001;&#x7684;&#x8D39;&#x7C73;&#x6D77;\n</p>\n\\begin{align*}\n  |GS\\rangle = |F \\rangle = \\prod_{k&lt; k_F}  a_{k,1}^{\\dagger} a_{k,3}^{\\dagger} |0\\rangle\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-orgabe55bf\" class=\"outline-3\">\n<h3 id=\"orgabe55bf\">Transition rate form 3 to 2</h3>\n<div class=\"outline-text-3\" id=\"text-orgabe55bf\">\n\\begin{align*}\n  I(\\omega) =&amp; 2\\pi \\sum_f |\\langle GS |V |f \\rangle|^2 \\delta(\\omega+\\mu -E_f +E_0) \\\\\n            =&amp; 2 \\sum_f |\\langle GS |V |f \\rangle|^2 \\mathrm{Im}\\frac{1}{\\omega +\\mu -E_f +E_0 -\\mathrm{i}0^{ +}} \\\\\n            \\propto &amp;\\mathrm{Im} \\sum_f \\langle GS |V \\frac{1}{\\omega +\\mu -E_f +E_0 -\\mathrm{i}0^{ +}} |f \\rangle\\langle f| V^{\\dagger} |GS\\rangle  \\\\\n            =&amp; \\mathrm{Im}  \\langle GS |V \\frac{1}{\\omega +\\mu -H +E_0 -\\mathrm{i}0^{ +}}  V^{\\dagger} |GS\\rangle  \\\\\n            =&amp; \\mathrm{Im}  \\langle GS |V \\frac{1}{\\omega - \\bar{H}} V^{\\dagger} |GS\\rangle\n\\end{align*}\n<p>\n&#x5176;&#x4E2D;\n</p>\n\\begin{align*}\n  \\bar{H} = H -E_0 -\\mu\n\\end{align*}\n<p>\n&#x7B2C;&#x4E8C;&#x4E2A;&#x7B49;&#x53F7;&#x7528;&#x5230;&#x4E86; Dirac Identity\n</p>\n\\begin{align*}\n  \\frac{1}{x - x_0 \\pm \\mathrm{i}0^+} = \\mathcal{P}\\frac{1}{x-x_0} \\mp \\mathrm{i}\\pi\\delta(x-x_0)\n\\end{align*}\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-org1f6e618\" class=\"outline-2\">\n<h2 id=\"org1f6e618\">&#x96F6;&#x6E29;&#x516C;&#x5F0F;&#x63A8;&#x5BFC;</h2>\n<div class=\"outline-text-2\" id=\"text-org1f6e618\">\n<p>\n&#x8003;&#x8651;&#x4E2D;&#x95F4;&#x6001; \\(|n\\rangle\\) &#x6709;&#x4E24;&#x79CD;\n</p>\n\\begin{align*}\n  |q \\rangle =&amp; a_{q,2}^{\\dagger} a_{q,3}| F\\rangle \\quad(q&lt; k_F)\\\\\n  |p,q \\rangle =&amp; b_{p+q}^{\\dagger} a_{p,1} a_{q_3}|F \\rangle \\quad(p,q&lt; k_F)\n\\end{align*}\n<p>\n&#x8026;&#x5408;&#x4F5C;&#x7528;&#x5230;&#x4E2D;&#x95F4;&#x6001;&#x4E0A;&#x7684;&#x7ED3;&#x679C;&#x4E3A;\n</p>\n\\begin{align*}\n  \\Lambda |q \\rangle =&amp;  \\sum_p |p,q\\rangle \\\\\n  \\Lambda |p,q\\rangle =&amp; |q \\rangle\n\\end{align*}\n<p>\n&#x4F5C;&#x7528;&#x662F;&#x5728;&#x4E24;&#x79CD;&#x4E2D;&#x95F4;&#x6001;&#x4E4B;&#x95F4;&#x5207;&#x6362;,\n&#x5219; \\(\\bar{H}\\) &#x5728;&#x7A7A;&#x95F4;&#x4E2D;&#x7684;&#x77E9;&#x9635;&#x5143;&#x4E3A;\n</p>\n\\begin{align*}\n  \\langle q |\\bar{H} |q \\rangle =&amp; \\varepsilon_{q,2} -\\varepsilon_{q,3} - \\mu = 0 \\\\\n  \\langle p,q|\\bar{H} |p,q \\rangle =&amp; \\delta + \\varepsilon_{p+q,b} - \\varepsilon_{p,1}-\\varepsilon_{q,3}-\\mu \\\\\n  \\langle q| \\bar{H}|p,q\\rangle  =&amp; \\langle p,q |\\bar{H} | q\\rangle = \\lambda/\\sqrt{\\Omega}\n\\end{align*}\n<p>\nTransition rate form 3 to 2 &#x5728;&#x4E0A;&#x8FF0;&#x7A7A;&#x95F4;&#x4E2D;&#x4E3A;\n</p>\n\\begin{align*}\n  I(\\omega) \\propto \\mathrm{Im}\\sum_{n,n&apos;} \\langle GS| V | n \\rangle \\langle n| \\frac{1}{\\omega-\\bar{H}} | n&apos;\\rangle \\langle n&apos; V^{\\dagger}|GS\\rangle\n\\end{align*}\n<p>\n&#x5C06;&#x8026;&#x5408; \\(\\lambda/\\sqrt{\\Omega}\\Lambda\\) &#x770B;&#x4F5C;&#x5C0F;&#x91CF;,&#x5373; \\(\\bar{H}= \\bar{H_0}+\\lambda/\\sqrt{\\Omega}\\Lambda\\) , &#x53EF;&#x505A;&#x5982;&#x4E0B;&#x5C55;&#x5F00;\n</p>\n\\begin{align*}\n  \\frac{1}{\\omega-\\bar{H}} &amp;=\\frac{1}{\\omega - \\bar{H_0}-\\lambda/\\sqrt{\\Omega}\\Lambda}\\\\\n  =&amp; \\frac{1}{\\omega - \\bar{H_0}}\\cdot \\left( \\frac{1}{1- \\frac{\\lambda}{\\sqrt{\\Omega}}\\frac{1}{\\omega-\\bar{H_0}}\\Lambda} \\right) \\\\\n  =&amp; \\frac{1}{\\omega - \\bar{H_0}}\\cdot \\sum_m \\left( \\frac{\\lambda}{\\sqrt{\\Omega}}\\frac{1}{\\omega-\\bar{H_0}}\\Lambda \\right)^m \\\\\n\\end{align*}\n<p>\n&#x800C;&#x4E14;&#x5C06;&#x5FAE;&#x6270; \\(V\\) &#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x4EE3;&#x5165;&#x6709;\n</p>\n\\begin{align*}\n  \\langle GS| V |n\\rangle = \\sum_q e^{\\mathrm{i}\\omega&apos;t}\\delta_{n,q}\\\\\n  \\langle n&apos;| V |GS\\rangle = \\sum_{q&apos;} e^{-\\mathrm{i}\\omega&apos;t}\\delta_{n&apos;,q&apos;}\\\\\n\\end{align*}\n<p>\n&#x6240;&#x4EE5;\n</p>\n\\begin{align*}\n  I(\\omega) \\propto&amp; \\mathrm{Im}\\sum_{q,q&apos;} \\langle q| \\frac{1}{\\omega-\\bar{H}} | q&apos;\\rangle \\\\\n  =&amp;\\mathrm{Im}\\sum_{q,q&apos;} \\langle q|\\frac{1}{\\omega - \\bar{H_0}}\\cdot \\sum_m \\left( \\frac{\\lambda}{\\sqrt{\\Omega}}\\frac{1}{\\omega-\\bar{H_0}}\\Lambda \\right)^m | q&apos;\\rangle \\\\\n\\end{align*}\n<p>\n&#x7531;&#x524D;&#x9762;&#x5F97;&#x51FA;&#x7684;&#x8026;&#x5408; \\(\\Lambda\\) &#x4F5C;&#x7528;&#x5728;&#x4E2D;&#x95F4;&#x6001;&#x4E0A;&#x7684;&#x7ED3;&#x679C;&#x53EF;&#x77E5;, &#x8026;&#x5408;&#x4F5C;&#x7528;&#x5947;&#x6570;&#x6B21;&#x4F1A;&#x7531;&#x4E8E;&#x6B63;&#x4EA4;&#x6027;&#x4F7F;&#x7ED3;&#x679C;&#x4E3A; \\(0\\) ( \\(\\bar{H_0}\\) &#x4E3A;&#x672C;&#x5F81;&#x6001;), &#x6240;&#x4EE5; \\(m\\) &#x53EA;&#x80FD;&#x53D6;&#x5076;&#x6570;.\n&#x800C;&#x4E14;&#x4E0D;&#x540C;&#x7684; \\(|q\\rangle\\) &#x4E5F;&#x662F;&#x6B63;&#x4EA4;&#x7684;, &#x6240;&#x4EE5;\n</p>\n\\begin{align*}\n  I(\\omega) \\propto&amp; \\mathrm{Im}\\sum_q \\langle q|\\frac{1}{\\omega - \\bar{H_0}}\\cdot \\sum_m \\left( \\frac{\\lambda}{\\sqrt{\\Omega}}\\frac{1}{\\omega-\\bar{H_0}}\\Lambda \\right)^{2m} | q\\rangle \\\\\n                 =&amp; \\mathrm{Im}\\sum_q \\langle q|\\frac{1}{\\omega - \\bar{H_0}}\\cdot \\sum_m \\left( \\frac{\\lambda^2}{\\Omega}\\frac{1}{\\omega-\\bar{H_0}}\\Lambda\\frac{1}{\\omega-\\bar{H_0}}\\Lambda \\right)^m | q\\rangle \\\\\n                 =&amp; \\mathrm{Im}\\sum_q \\langle q|\\frac{1}{\\omega - \\bar{H_0}}\\cdot \\frac{1}{1-  \\frac{\\lambda^2}{\\Omega}\\frac{1}{\\omega-\\bar{H_0}}\\Lambda\\frac{1}{\\omega-\\bar{H_0}}\\Lambda } | q\\rangle \\\\\n                 =&amp; \\mathrm{Im}\\sum_q \\langle q|\\frac{1}{\\frac{1}{\\omega - \\bar{H_0}}-  \\frac{\\lambda^2}{\\Omega}\\Lambda\\frac{1}{\\omega-\\bar{H_0}}\\Lambda } | q\\rangle \\\\\n                 =&amp; \\mathrm{Im}\\sum_{q&lt; q_F}\\frac{1}{\\omega+ \\mu +\\varepsilon_{q,3}-\\varepsilon_{q,2}-\\lambda^2 \\theta(q,\\omega)}\n\\end{align*}\n<p>\n&#x5176;&#x4E2D;\n</p>\n\\begin{align*}\n  \\theta(q,\\omega) = \\frac{1}{\\Omega} \\sum_{p&lt; k_F} \\frac{1}{\\omega+ \\mu  + \\varepsilon_{q,3}+\\varepsilon_{p,1} - \\varepsilon_{p+q,b}-\\delta}\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-org628f0db\" class=\"outline-2\">\n<h2 id=\"org628f0db\">&#x96F6;&#x6E29;&#x6570;&#x503C;</h2>\n<div class=\"outline-text-2\" id=\"text-org628f0db\">\n</div>\n<div id=\"outline-container-orgcd599da\" class=\"outline-3\">\n<h3 id=\"orgcd599da\">&#x5316;&#x7B80;&#x516C;&#x5F0F;</h3>\n<div class=\"outline-text-3\" id=\"text-orgcd599da\">\n\\begin{align*}\n  \\mu + \\varepsilon_{q,3} -\\varepsilon_{q,2} = 0\n\\end{align*}\n<p>\n&#x6240;&#x4EE5;\n</p>\n\\begin{align*}\n  I(\\omega) \\propto &amp; \\mathrm{Im} \\sum_{q&lt; q_{F}} \\frac{1}{\\omega -\\lambda^2 \\theta(q,\\omega)} \\\\\n  =&amp; \\sum_{q&lt; k_F} \\frac{\\lambda^2\\mathrm{Im}\\theta(q,\\omega)}{\\left[\n  \\omega - \\lambda^2 \\mathrm{Re}\\theta(q,\\omega) \\right]^2\n  + \\left[ \\lambda^2 \\mathrm{Im}\\theta(q,\\omega) \\right]^2}\n\\end{align*}\n\n<p>\n&#x800C;\n</p>\n\\begin{align*}\n  \\theta(q,\\omega) =&amp; \\frac{1}{\\Omega}\\sum_{p&lt; k_F} \\frac{1}{\\omega + \\frac{\\hbar^2}{4m}\\left(\n   p-q\\right)^2-\\delta}\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-org92839d5\" class=\"outline-3\">\n<h3 id=\"org92839d5\">&#x65E0;&#x91CF;&#x7EB2;&#x5316;</h3>\n<div class=\"outline-text-3\" id=\"text-org92839d5\">\n<p>\n&#x5BF9;&#x4EE5;&#x4E0B;&#x91CF;&#x8FDB;&#x884C;&#x65E0;&#x91CF;&#x7EB2;&#x5316;:\n</p>\n\\begin{align*}\n  \\tilde{\\omega} = \\frac{\\omega}{\\varepsilon_F} ;\\quad\n  \\tilde{\\delta} = \\frac{\\delta}{\\varepsilon_F} ;\\quad\n  \\tilde{p} = \\frac{p}{k_F} ;\\quad \\\\\n  \\tilde{q} = \\frac{q}{k_F}; \\quad\n  \\tilde{\\lambda}^2 = \\frac{\\lambda^2}{\\Omega \\varepsilon_F^2}\n\\end{align*}\n\n<p>\n&#x539F;&#x5F0F;&#x5C31;&#x53D8;&#x4E3A;\n</p>\n\\begin{align*}\n  \\theta(\\tilde{q},\\tilde{\\omega}) =&amp; \\frac{1}{\\Omega \\varepsilon_F} \\sum_{\\tilde{p}&lt; 1}\n  \\frac{1}{\\tilde{\\omega} + \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 -\\tilde{\\delta} } \\\\\n  =&amp;\\frac{1}{\\Omega\\varepsilon_F}(B+ \\mathrm{i}A)\n\\end{align*}\n<p>\n&#x5176;&#x4E2D;\n</p>\n\\begin{align*}\n  A =&amp; \\pi \\sum_{\\tilde{p}&lt; 1}  \\delta\\left( \\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 \\right) \\\\\n  B =&amp; \\sum_{\\tilde{p} &lt; 1} \\mathcal{P}\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 }\n\\end{align*}\n<p>\nTransition rate &#x5C31;&#x8BB0;&#x4E3A;:\n</p>\n\\begin{align*}\n  \\varepsilon_F I(\\tilde{\\omega}) =\\sum_{\\tilde{q}&lt; 1} \\frac{ \\tilde{\\lambda}^2A}{\\left(\n  \\tilde{\\omega} -\\tilde{\\lambda}^2 B\\right)^2+\\tilde{\\lambda}^4 A^2}\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-orgf939982\" class=\"outline-3\">\n<h3 id=\"orgf939982\">&#x6570;&#x503C;&#x5904;&#x7406;</h3>\n<div class=\"outline-text-3\" id=\"text-orgf939982\">\n<p>\nDirac Delta &#x51FD;&#x6570;&#x548C;&#x4E3B;&#x503C;&#x5206;&#x522B;&#x7528;&#x5176;&#x6781;&#x9650;&#x5F62;&#x5F0F;:\n</p>\n\\begin{align*}\n  \\delta(x) =&amp; \\frac{1}{\\pi} \\lim_{b\\to 0}\\frac{b}{b^2+x^2} \\\\\n  \\mathcal{P}\\frac{1}{x} =&amp; \\lim_{b\\to 0}\\frac{x}{b^2+x^2}\n\\end{align*}\n<p>\n&#x8BA1;&#x7B97;&#x4E2D; \\(b=0.0001\\) .\n</p>\n\n<p>\n&#x6C42;&#x548C;&#x8FD1;&#x4F3C;&#x4E3A;&#x4ECE; \\(0\\) &#x5230; \\(1\\) &#x7684;&#x79EF;&#x5206;.\n</p>\n\n<p>\n&#x6570;&#x503C;&#x53D6;&#x503C;&#x4E3A;\n</p>\n\\begin{align*}\n  \\tilde{\\lambda} = 1\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-orge66f7ae\" class=\"outline-3\">\n<h3 id=\"orge66f7ae\">&#x7ED3;&#x679C;</h3>\n<div class=\"outline-text-3\" id=\"text-orge66f7ae\">\n</div>\n<div id=\"outline-container-org4c65ca8\" class=\"outline-4\">\n<h4 id=\"org4c65ca8\">code</h4>\n<div class=\"outline-text-4\" id=\"text-org4c65ca8\">\n<div class=\"org-src-container\">\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> integrate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># &#x5B9A;&#x4E49;&#x53D8;&#x91CF;</span></span><br><span class=\"line\">l = <span class=\"number\">1</span> <span class=\"comment\"># lambd_tilde</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#&#x753B;&#x56FE;&#x7684;&#x7CBE;&#x5EA6;</span></span><br><span class=\"line\">N = <span class=\"number\">1000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># &#x5B9A;&#x4E49;delta&#x51FD;&#x6570;</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delta</span><span class=\"params\">(x)</span>:</span></span><br><span class=\"line\">    b = <span class=\"number\">.0001</span></span><br><span class=\"line\">    f = b/(b**<span class=\"number\">2</span> + x**<span class=\"number\">2</span>)/np.pi</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f</span><br><span class=\"line\"><span class=\"comment\"># &#x5B9A;&#x4E49;&#x4E3B;&#x503C;&#x51FD;&#x6570;</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">pv</span><span class=\"params\">(x)</span>:</span></span><br><span class=\"line\">    b = <span class=\"number\">0.0001</span></span><br><span class=\"line\">    f = x/(b*<span class=\"number\">2</span> + x**<span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># &#x5B9A;&#x4E49;&#x6700;&#x7EC8;&#x60F3;&#x8981;&#x5F97;&#x5230;&#x7684;&#x51FD;&#x6570;</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">I</span><span class=\"params\">(o,d)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">I</span><span class=\"params\">(q)</span>:</span><span class=\"comment\">#&#x5B9A;&#x4E49;&#x6CA1;&#x6709;&#x79EF;&#x5206;&#x7684;&#x7ED3;&#x679C;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">A</span><span class=\"params\">(q)</span>:</span><span class=\"comment\">#&#x5B9A;&#x4E49;theta&#x7684;&#x865A;&#x90E8;</span></span><br><span class=\"line\">\t    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">A</span><span class=\"params\">(p)</span>:</span></span><br><span class=\"line\">\t\tx = o + (p-q)**<span class=\"number\">2</span>/<span class=\"number\">2</span> - d</span><br><span class=\"line\">\t\tA =np.pi * delta(x)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> A</span><br><span class=\"line\">\t    (fres,err) = integrate.quad(A,<span class=\"number\">0</span>,<span class=\"number\">1</span>)</span><br><span class=\"line\">\t    <span class=\"keyword\">return</span> fres</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">B</span><span class=\"params\">(q)</span>:</span><span class=\"comment\">#&#x5B9A;&#x4E49;theta&#x7684;&#x5B9E;&#x90E8;</span></span><br><span class=\"line\">\t    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">B</span><span class=\"params\">(p)</span>:</span></span><br><span class=\"line\">\t\tx = o + (p-q)**<span class=\"number\">2</span>/<span class=\"number\">2</span> - d</span><br><span class=\"line\">\t\tB = pv(x)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> B</span><br><span class=\"line\">\t    (fres,err) = integrate.quad(B,<span class=\"number\">0</span>,<span class=\"number\">1</span>)</span><br><span class=\"line\">\t    <span class=\"keyword\">return</span> fres</span><br><span class=\"line\"></span><br><span class=\"line\">\tI = l**<span class=\"number\">2</span>*A(q) / ( (o-l**<span class=\"number\">2</span>*B(q))**<span class=\"number\">2</span> + l**<span class=\"number\">4</span>*A(q)**<span class=\"number\">2</span> )</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> I</span><br><span class=\"line\"></span><br><span class=\"line\">    (fres,err) = integrate.quad(I,<span class=\"number\">0</span>,<span class=\"number\">1</span>)<span class=\"comment\">#&#x5BF9;&#x5176;&#x79EF;&#x5206;,&#x5373;&#x5F97;&#x5230;&#x6700;&#x7EC8;&#x7ED3;&#x679C;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>(fres)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#&#x753B;&#x56FE;&#x7684;&#x6A2A;&#x5750;&#x6807;omega&#x4ECE;-2&#x53D6;&#x5230;2</span></span><br><span class=\"line\">omega = np.linspace(-<span class=\"number\">2</span>,<span class=\"number\">2</span>,N)</span><br><span class=\"line\"></span><br><span class=\"line\">C = <span class=\"number\">33</span> <span class=\"comment\"># &#x753B;C&#x6839;&#x7EBF;</span></span><br><span class=\"line\"><span class=\"comment\">#&#x6C42;&#x51FA;&#x60F3;&#x8981;&#x7684;&#x51FD;&#x6570;&#x5728;&#x6A2A;&#x5750;&#x6807;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x5185;&#x7684;&#x7ED3;&#x679C;</span></span><br><span class=\"line\">I_omega = np.linspace(<span class=\"number\">0</span>,<span class=\"number\">0</span>,N)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range (C):</span><br><span class=\"line\">    d = j-(C-<span class=\"number\">1</span>)/<span class=\"number\">2</span></span><br><span class=\"line\">    d = d/<span class=\"number\">2</span> <span class=\"comment\">#&#x95F4;&#x8DDD;&#x662F;&#x5206;&#x6BCD;&#x5206;&#x4E4B;&#x4E00;</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(N):</span><br><span class=\"line\">\tI_omega[i-<span class=\"number\">1</span>] = I(omega[i-<span class=\"number\">1</span>],d)</span><br><span class=\"line\">\tprint(d)</span><br><span class=\"line\">\tprint(i-<span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.plot(omega,I_omega+<span class=\"number\">100</span>*j, label=<span class=\"string\">&apos;d= %.2f&apos;</span> %(d) , color=<span class=\"string\">&apos;gray&apos;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#plt.legend()</span></span><br><span class=\"line\"></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-orgee067ca\" class=\"outline-4\">\n<h4 id=\"orgee067ca\">fig</h4>\n<div class=\"outline-text-4\" id=\"text-orgee067ca\">\n<p>\n&#x7ED3;&#x679C;&#x5982;&#x56FE;\n</p>\n\n<p>\n<img src=\"fig4a.jpeg\">\n&#x56FE;&#x4E2D;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;, \\(\\tilde{\\delta}\\) &#x5728;&#x533A;&#x95F4; \\([8,-8]\\) &#x6BCF;&#x95F4;&#x9694; \\(0.5\\) &#x53D6;&#x4E00;&#x4E2A;&#x503C;.\n</p>\n\n<p>\n&#x4E0A;&#x56FE;&#x7684;&#x5CF0;&#x4E00;&#x4E9B;&#x5C16;. &#x5982;&#x679C; Dirac delta &#x51FD;&#x6570;&#x4E2D;&#x7684;&#x53C2;&#x6570; \\(b\\) &#x53D6;&#x5F97;&#x66F4;&#x5927;&#x4E00;&#x4E9B;, &#x56FE;&#x5C31;&#x4F1A;&#x5E73;&#x6ED1;&#x4E00;&#x4E9B;.\n</p>\n\n<p>\n&#x4E0B;&#x56FE;&#x662F; \\(b=0.5\\) &#x65F6;&#x7684;&#x7ED3;&#x679C;. &#x4E3A;&#x4E86;&#x76F4;&#x89C2;,&#x7EBF;&#x7684;&#x95F4;&#x8DDD;&#x4E5F;&#x7531; \\(100\\) &#x6539;&#x4E3A; \\(10\\) . \n</p>\n\n\n<div class=\"figure\">\n<p><img src=\"fig4a_b=.5.jpeg\">\n</p>\n</div>\n\n\n\n<p>\neps&#x77E2;&#x91CF;&#x56FE;:\n<a href=\"fig4a.eps\">fig4a.eps</a>\n</p>\n</div>\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-orgd1fbe6c\" class=\"outline-2\">\n<h2 id=\"orgd1fbe6c\">&#x96F6;&#x6E29;&#x89E3;&#x6790;</h2>\n<div class=\"outline-text-2\" id=\"text-orgd1fbe6c\">\n</div>\n<div id=\"outline-container-orgabaa2fa\" class=\"outline-3\">\n<h3 id=\"orgabaa2fa\">&#x63A8;&#x5BFC;&#x56DE;&#x987E;</h3>\n<div class=\"outline-text-3\" id=\"text-orgabaa2fa\">\n<p>\n&#x539F;&#x516C;&#x5F0F;&#x4E3A;:\n</p>\n\\begin{align*}\n  I(\\omega) \\propto\n                  \\mathrm{Im}\\sum_{q&lt; q_F}\\frac{1}{\\omega+ \\mu +\\varepsilon_{q,3}-\\varepsilon_{q,2}-\\lambda^2 \\theta(q,\\omega)}\n\\end{align*}\n<p>\n&#x5176;&#x4E2D;\n</p>\n\\begin{align*}\n  \\theta(q,\\omega) = \\frac{1}{\\Omega} \\sum_{p&lt; k_F} \\frac{1}{\\omega+ \\mu  + \\varepsilon_{q,3}+\\varepsilon_{p,1} - \\varepsilon_{p+q,b}-\\delta}\n\\end{align*}\n<p>\n&#x8FDB;&#x884C;&#x5316;&#x7B80;, &#x9996;&#x5148;&#x5728;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E2D;&#x6709;&#x5982;&#x4E0B;&#x5173;&#x7CFB;\n</p>\n\\begin{align*}\n  \\mu + \\varepsilon_{q,3} -\\varepsilon_{q,2} = 0\n\\end{align*}\n<p>\n&#x6240;&#x4EE5;&#x539F;&#x5F0F;&#x53EF;&#x4EE5;&#x5316;&#x4E3A;:\n</p>\n\\begin{align*}\n  I(\\omega) \\propto  \\sum_{q&lt; k_F} \\frac{\\lambda^2\\mathrm{Im}\\theta(q,\\omega)}{\\left[\n  \\omega - \\lambda^2 \\mathrm{Re}\\theta(q,\\omega) \\right]^2\n  + \\left[ \\lambda^2 \\mathrm{Im}\\theta(q,\\omega) \\right]^2}\n\\end{align*}\n<p>\n&#x5176;&#x4E2D;\n</p>\n\\begin{align*}\n  \\theta(q,\\omega) =&amp; \\frac{1}{\\Omega}\\sum_{p&lt; k_F} \\frac{1}{\\omega + \\frac{\\hbar^2}{4m}\\left(\n   p-q\\right)^2-\\delta}\n\\end{align*}\n\n\n<p>\n&#x5BF9;&#x4EE5;&#x4E0B;&#x91CF;&#x8FDB;&#x884C;&#x65E0;&#x91CF;&#x7EB2;&#x5316;:\n</p>\n\\begin{align*}\n  \\tilde{\\omega} = \\frac{\\omega}{\\varepsilon_F} ;\\quad\n  \\tilde{\\delta} = \\frac{\\delta}{\\varepsilon_F} ;\\quad\n  \\tilde{p} = \\frac{p}{k_F} ;\\quad \\\\\n  \\tilde{q} = \\frac{q}{k_F}; \\quad\n  \\tilde{\\lambda}^2 = \\frac{\\lambda^2}{\\Omega \\varepsilon_F^2}\n\\end{align*}\n\n<p>\n&#x539F;&#x5F0F;&#x5C31;&#x53D8;&#x4E3A;\n</p>\n\\begin{align}\n  \\varepsilon_F I(\\tilde{\\omega}) =\\sum_{\\tilde{q}&lt; 1} \\frac{ \\tilde{\\lambda}^2A}{\\left(\n  \\tilde{\\omega} -\\tilde{\\lambda}^2 B\\right)^2+\\tilde{\\lambda}^4 A^2}\n\\end{align}\n<p>\n&#x5176;&#x4E2D;\n</p>\n\\begin{align}\n  A =&amp; \\pi \\sum_{\\tilde{p}&lt; 1}  \\delta\\left( \\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 \\right) \\\\\n  B =&amp; \\sum_{\\tilde{p} &lt; 1} \\mathcal{P}\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 }\n\\end{align}\n</div>\n</div>\n\n<div id=\"outline-container-org12d342b\" class=\"outline-3\">\n<h3 id=\"org12d342b\">&#x89E3;&#x6790;&#x8BA1;&#x7B97;</h3>\n<div class=\"outline-text-3\" id=\"text-org12d342b\">\n<p>\n&#x6C42;&#x548C;&#x5316;&#x79EF;&#x5206;\n</p>\n\\begin{align*}\n  A \\approx&amp; \\pi \\frac{Vk^3_F}{(2\\pi)^3} \\int_{|\\tilde{p}| &lt; 1}\\mathrm{d}^3\\tilde{p} \\cdot \\delta\\left( \\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 \\right) =\\pi \\frac{Vk^3_F}{(2\\pi)^3} a\\\\\n  B \\approx&amp; \\frac{Vk^3_F}{(2\\pi)^3} \\int_{|\\tilde{p}| &lt; 1}\\mathrm{d}^3\\tilde{p} \\cdot\\mathcal{P}\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 } = \\frac{Vk^3_F}{(2\\pi)^3} b\n\\end{align*}\n<p>\n&#x89E3;&#x6790;&#x7684;&#x8BA1;&#x7B97;&#x79EF;&#x5206; \\(a\\) &#x548C; \\(b\\)\n</p>\n\\begin{align*}\n  a =&amp;2\\pi \\int_{-1}^{1}\\mathrm{d}x \\int_0^1\\mathrm{d}\\tilde{p} \\cdot \\delta\\left( \\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{\\tilde{p}^2}{2} +\\frac{\\tilde{q}^2}{2} -\\tilde{p}\\tilde{q}x \\right) \\tilde{p}^2\\\\\n  b =&amp;2\\pi\\int_{-1}^{1}\\mathrm{d}x \\int_0^1\\mathrm{d}\\tilde{p} \\cdot\\mathcal{P}\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{\\tilde{p}^2}{2} +\\frac{\\tilde{q}^2}{2} -\\tilde{p}\\tilde{q}x }\\tilde{p}^2\n\\end{align*}\n\n<p>\n&#x79EF;&#x5206; \\(a\\) &#x662F;&#x4E00;&#x4E2A;&#x5BF9; \\(\\delta\\) &#x51FD;&#x6570;&#x5728; \\([0,1]\\) &#x533A;&#x95F4;&#x5185;&#x7684;&#x79EF;&#x5206;. &#x6240;&#x4EE5;&#x8981;&#x5BF9; \\(\\delta\\) &#x51FD;&#x6570;&#x5185;&#x7684;\n&#x90E8;&#x5206;&#x5206;&#x60C5;&#x51B5;&#x8BA8;&#x8BBA;.\n</p>\n\n<p>\n&#x5982;&#x679C; \\(\\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{\\tilde{p}^2}{2} +\\frac{\\tilde{q}^2}{2} -\\tilde{p}\\tilde{q}x = 0\\)\n&#x6CA1;&#x6709;&#x6839;, &#x90A3;&#x4E48;&#x79EF;&#x5206; \\(a=0\\) . &#x5982;&#x679C;&#x6709;&#x6839;, &#x8BB0;&#x4E24;&#x4E2A;&#x6839;&#x4E3A; \\(r_1, r_2\\) , &#x90A3;&#x4E48;&#x79EF;&#x5206; \\(a\\) &#x5316;&#x4E3A;\n</p>\n\\begin{align*}\n  a =&amp;2\\pi\\int_{-1}^{1}\\mathrm{d}x \\int_0^1\\mathrm{d}\\tilde{p}  \\cdot \\delta\\left[ (\\tilde{p}-r_1)(\\tilde{p}-r_2) \\right] \\tilde{p}^2 \\\\\n    =&amp;2\\pi\\frac{1}{|r_1-r_2|} \\int_{-1}^{1}\\mathrm{d}x \\int_0^1\\mathrm{d}\\tilde{p} \\cdot \\left[ \\delta(\\tilde{p}-r_1)\n    +\\delta(\\tilde{p}-r_2) \\right] \\tilde{p}^2\n\\end{align*}\n\n<p>\n&#x79EF;&#x5206; \\(b\\) &#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x4E3B;&#x503C;&#x7684;&#x79EF;&#x5206;,&#x4E5F;&#x9700;&#x8981;&#x5206;&#x60C5;&#x51B5;&#x8BA8;&#x8BBA;.\n</p>\n\n<p>\n&#x5982;&#x679C; \\(\\tilde{\\omega}-\\tilde{\\delta} +\\frac{\\tilde{p}^2}{2} +\\frac{\\tilde{q}^2}{2} -\\tilde{p}\\tilde{q}x =0\\)\n&#x6CA1;&#x6709;&#x6839;, &#x90A3;&#x4E48;&#x5B83;&#x5C31;&#x53EF;&#x4EE5;&#x5F53;&#x505A;&#x666E;&#x901A;&#x7684;&#x79EF;&#x5206;\n</p>\n\\begin{align*}\n    b =&amp;\\int_0^1\\mathrm{d}\\tilde{p} \\cdot \\frac{1}{\\tilde{\\omega}-\\tilde{\\delta} +\n  \\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 } \\\\\n      =&amp;\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta}} \\int_0^1 \\mathrm{d}\\tilde{p} \\cdot\n        \\frac{1}{1+\\left( \\frac{\\tilde{p}- \\tilde{q}}{ \\sqrt{2(\\tilde{\\omega} -\\tilde{\\delta})} } \\right)^2} \\\\\n      =&amp;\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta}} \\cdot \\left[ \\arctan(t)\n        \\right]_{t==\\frac{-\\tilde{q}}{ \\sqrt{2(\\tilde{\\omega} -\\tilde{\\delta})} }}\n          ^{t=\\frac{1-\\tilde{q}}{ \\sqrt{2(\\tilde{\\omega} -\\tilde{\\delta})} }}\n\\end{align*}\n<p>\n&#x5982;&#x6709;&#x4E24;&#x4E2A;&#x6839; \\(r_1, r_2\\) &#x90A3;&#x4E48;\n</p>\n\\begin{align*}\n    b =&amp;\\int_0^1\\mathrm{d}\\tilde{p} \\cdot \\mathcal{P} \\frac{1}{(\\tilde{p}-r_1)(\\tilde{p}-r_2)} \\\\\n      =&amp;\\frac{1}{r_1-r_2}\\int_0^1\\mathrm{d}\\tilde{p} \\cdot\\left[ \\mathcal{P}\n          \\frac{1}{\\tilde{p}-r_1}-\\mathcal{P}\\frac{1}{\\tilde{p}-r_2}\\right]\n\\end{align*}\n\n<p>\n&#x4E24;&#x4E2A;&#x6839; \\(r_1, r_2\\) &#x662F;&#x5426;&#x5728;&#x79EF;&#x5206;&#x533A;&#x95F4; \\([0,1]\\) &#x4E4B;&#x95F4;&#x4E5F;&#x4F1A;&#x5BF9;&#x79EF;&#x5206; \\(a, b\\) &#x7684;&#x7ED3;&#x679C;&#x6709;&#x5F71;&#x54CD;.\n</p>\n</div>\n</div>\n\n<div id=\"outline-container-org4160304\" class=\"outline-3\">\n<h3 id=\"org4160304\">&#x6839;&#x636E;&#x6839;&#x7684;&#x60C5;&#x51B5;&#x8BA8;&#x8BBA;&#x79EF;&#x5206;&#x7ED3;&#x679C;</h3>\n<div class=\"outline-text-3\" id=\"text-org4160304\">\n\\begin{align}\n  \\tilde{\\omega}-\\tilde{\\delta} +\\frac{1}{2}(\\tilde{p}-\\tilde{q})^2 = 0\n\\end{align}\n<p>\n&#x5982;&#x679C;&#x6709;&#x6839;, &#x8BB0; \\(r_1 = \\tilde{q} + \\sqrt{2(\\tilde{\\delta}-\\tilde{\\omega})},\nr_1 = \\tilde{q} + \\sqrt{2(\\tilde{\\delta}-\\tilde{\\omega})}\\) . &#x5F53;\n\\(\\tilde{p}, \\tilde{\\omega}\\) &#x53D6;&#x4E0D;&#x540C;&#x7684;&#x503C;&#x65F6;, &#x6839;&#x7684;&#x60C5;&#x51B5;&#x5982;&#x56FE;\n</p>\n\n\n<div class=\"figure\">\n<p><img src=\"root.png\">\n</p>\n</div>\n\n<p>\nno root &#x65F6;\n</p>\n\\begin{align*}\n  a =&amp;0 \\\\\n  b = &amp;\\frac{1}{\\tilde{\\omega}-\\tilde{\\delta}} \\cdot \\left[ \\arctan(t)\n        \\right]_{t==\\frac{-\\tilde{q}}{ \\sqrt{2(\\tilde{\\omega} -\\tilde{\\delta})a} }}\n          ^{t=\\frac{1-\\tilde{q}}{ \\sqrt{2(\\tilde{\\omega} -\\tilde{\\delta})} }}\n\\end{align*}\n\n<p>\n\\(r_1, r_2 \\in [0,1]\\) &#x65F6;\n</p>\n\\begin{align*}\n  a =&amp; \\frac{1}{ \\sqrt{2(\\tilde{\\delta}-\\tilde{\\omega})} } \\\\\n  b =&amp; \\frac{1}{r_1-r_2} \\ln \\frac{ (1-r_1)r_2 }{ (1-r_2)r_1 }\n\\end{align*}\n\n<p>\n\\(r_1\\in [0,1]\\) &#x548C; \\(r_2 \\in [0,1]\\) &#x65F6;\n</p>\n\\begin{align*}\n  a =&amp; \\frac{1}{2 \\sqrt{2(\\tilde{\\delta}-\\tilde{\\omega})} } \\\\\n  b =&amp; \\frac{1}{r_1-r_2} \\ln \\frac{ -(1-r_1)r_2 }{ (1-r_2)r_1 }\n\\end{align*}\n\n<p>\n\\(r_1, r_2 \\notin [0,1]\\) &#x65F6;\n</p>\n\\begin{align*}\n  a =&amp;0 \\\\\n  b =&amp; \\frac{1}{r_1-r_2} \\ln \\frac{ (1-r_1)r_2 }{ (1-r_2)r_1 }\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-org6472422\" class=\"outline-3\">\n<h3 id=\"org6472422\">&#x4EE3;&#x56DE;&#x539F;&#x5F0F;</h3>\n<div class=\"outline-text-3\" id=\"text-org6472422\">\n\\begin{align*}\n  \\varepsilon_F I(\\tilde{\\omega}) =&amp;\\sum_{\\tilde{q}&lt; 1} \\frac{ \\tilde{\\lambda}^2A}{\\left(\n  \\tilde{\\omega} -\\tilde{\\lambda}^2 B\\right)^2+\\tilde{\\lambda}^4 A^2} \\\\\n    \\approx&amp; \\int_0^1 \\mathrm{d}\\tilde{q}\\cdot \\frac{ \\tilde{\\lambda}^2 \\pi A}{\\left(\n  \\frac{(2\\pi)^3}{Vk_F}\\tilde{\\omega} -\\tilde{\\lambda}^2 B\\right)^2+\\tilde{\\lambda}^4 \\pi^2 A^2}\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-org3cb8556\" class=\"outline-3\">\n<h3 id=\"org3cb8556\">&#x79EF;&#x5206;&#x548C;&#x7ED3;&#x679C;</h3>\n<div class=\"outline-text-3\" id=\"text-org3cb8556\">\n</div>\n<div id=\"outline-container-orgbda20c9\" class=\"outline-4\">\n<h4 id=\"orgbda20c9\">code</h4>\n<div class=\"outline-text-4\" id=\"text-orgbda20c9\">\n<div class=\"org-src-container\">\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> integrate</span><br><span class=\"line\"></span><br><span class=\"line\">l = <span class=\"number\">1</span>                           <span class=\"comment\"># &#x5B9A;&#x4E49;&#x53D8;&#x91CF;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delta</span><span class=\"params\">(x)</span>:</span></span><br><span class=\"line\">    b = <span class=\"number\">.01</span></span><br><span class=\"line\">    f = b/(b**<span class=\"number\">2</span> + x**<span class=\"number\">2</span>)/np.pi</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">I</span><span class=\"params\">(o,d)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">I</span><span class=\"params\">(q)</span>:</span></span><br><span class=\"line\">\tr1 = q + np.sqrt( <span class=\"number\">2</span>*(d-o) )</span><br><span class=\"line\">\tr2 = q - np.sqrt( <span class=\"number\">2</span>*(d-o) )</span><br><span class=\"line\"></span><br><span class=\"line\">\ta1 = <span class=\"number\">0</span>                  <span class=\"comment\"># &#x65E0;&#x6839;</span></span><br><span class=\"line\">\tb1 = <span class=\"number\">1</span>/(o-d) * ( \\</span><br><span class=\"line\">\t\t\t np.arctan( (<span class=\"number\">1</span>-q)/np.sqrt( <span class=\"number\">2</span>*(o-d) )  ) - \\</span><br><span class=\"line\">\t\t\t np.arctan( ( -q)/np.sqrt( <span class=\"number\">2</span>*(o-d) )  ))</span><br><span class=\"line\"></span><br><span class=\"line\">\ta2 = <span class=\"number\">1</span>/np.sqrt( <span class=\"number\">2</span>*(d-o) ) <span class=\"comment\"># &#x6839;&#x90FD;&#x5728;&#x79EF;&#x5206;&#x533A;&#x95F4;&#x5185;</span></span><br><span class=\"line\">\tb2 = <span class=\"number\">1</span>/(r1-r2)*np.log( ( (<span class=\"number\">1</span>-r1)*r2 )/ \\</span><br><span class=\"line\">\t\t\t       ( (<span class=\"number\">1</span>-r2)*r1 ) )</span><br><span class=\"line\"></span><br><span class=\"line\">\ta3 = <span class=\"number\">.5</span>/np.sqrt( <span class=\"number\">2</span>*(d-o) ) <span class=\"comment\"># &#x4E00;&#x5185;&#x4E00;&#x5916;</span></span><br><span class=\"line\">\tb3 = <span class=\"number\">1</span>/(r1-r2)*np.log(-( (<span class=\"number\">1</span>-r1)*r2 )/ \\</span><br><span class=\"line\">\t\t\t       ( (<span class=\"number\">1</span>-r2)*r1 ) )</span><br><span class=\"line\"></span><br><span class=\"line\">\ta4 = <span class=\"number\">0</span>                   <span class=\"comment\"># &#x90FD;&#x5728;&#x5916;</span></span><br><span class=\"line\">\tb4 = b2</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> o&gt;d:</span><br><span class=\"line\">\t    A, B = a1, b1</span><br><span class=\"line\">\t    case = <span class=\"number\">1</span></span><br><span class=\"line\">\t<span class=\"keyword\">elif</span> o&gt;(d-q**<span class=\"number\">2</span>/<span class=\"number\">2</span>) <span class=\"keyword\">and</span> o&gt;(d-(<span class=\"number\">1</span>-q)**<span class=\"number\">2</span>/<span class=\"number\">2</span>):</span><br><span class=\"line\">\t    A, B = a2, b2</span><br><span class=\"line\">\t    case = <span class=\"number\">2</span></span><br><span class=\"line\">\t<span class=\"keyword\">elif</span> o&gt;(d-q**<span class=\"number\">2</span>/<span class=\"number\">2</span>) <span class=\"keyword\">or</span> o&gt;(d-(<span class=\"number\">1</span>-q)**<span class=\"number\">2</span>/<span class=\"number\">2</span>):</span><br><span class=\"line\">\t    A, B = a3, b3</span><br><span class=\"line\">\t    case = <span class=\"number\">3</span></span><br><span class=\"line\">\t<span class=\"keyword\">else</span>:</span><br><span class=\"line\">\t    A, B = a4, b4</span><br><span class=\"line\">\t    case = <span class=\"number\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> case == <span class=\"number\">2</span> <span class=\"keyword\">or</span> case == <span class=\"number\">3</span>:</span><br><span class=\"line\">\t    I = l**<span class=\"number\">2</span>*A / ( (o-l**<span class=\"number\">2</span>*B)**<span class=\"number\">2</span> + l**<span class=\"number\">4</span>*A**<span class=\"number\">2</span> )</span><br><span class=\"line\">\t<span class=\"keyword\">else</span>:</span><br><span class=\"line\">\t    I = delta(o - l**<span class=\"number\">2</span>*B)</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> I</span><br><span class=\"line\">    (fres, err) = integrate.quad(I, <span class=\"number\">0</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fres</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"comment\">#&#x753B;&#x56FE;&#x7684;&#x6A2A;&#x5750;&#x6807;omega&#x4ECE;-2&#x53D6;&#x5230;2</span></span><br><span class=\"line\">omega = np.linspace(-<span class=\"number\">2</span>,<span class=\"number\">2</span>,N)</span><br><span class=\"line\"></span><br><span class=\"line\">C = <span class=\"number\">33</span> <span class=\"comment\"># &#x753B;C&#x6839;&#x7EBF;</span></span><br><span class=\"line\"><span class=\"comment\">#&#x6C42;&#x51FA;&#x60F3;&#x8981;&#x7684;&#x51FD;&#x6570;&#x5728;&#x6A2A;&#x5750;&#x6807;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x5185;&#x7684;&#x7ED3;&#x679C;</span></span><br><span class=\"line\">I_omega = np.linspace(<span class=\"number\">0</span>,<span class=\"number\">0</span>,N)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range (C):</span><br><span class=\"line\">    d = j-(C-<span class=\"number\">1</span>)/<span class=\"number\">2</span></span><br><span class=\"line\">    d = d/<span class=\"number\">2</span> <span class=\"comment\">#&#x95F4;&#x8DDD;&#x662F;&#x5206;&#x6BCD;&#x5206;&#x4E4B;&#x4E00;</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(N):</span><br><span class=\"line\">\tI_omega[i-<span class=\"number\">1</span>] = I(omega[i-<span class=\"number\">1</span>],d)</span><br><span class=\"line\">\tprint(d)</span><br><span class=\"line\">\tprint(i-<span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.plot(omega,I_omega+j*<span class=\"number\">10</span>, label=<span class=\"string\">&apos;d= %.2f&apos;</span> %(d) , color=<span class=\"string\">&apos;gray&apos;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-orge6f63ad\" class=\"outline-3\">\n<h3 id=\"orge6f63ad\">fig</h3>\n</div>\n</div>\n\n<div id=\"outline-container-orgb51d213\" class=\"outline-2\">\n<h2 id=\"orgb51d213\">&#x6709;&#x9650;&#x6E29;&#x516C;&#x5F0F;&#x63A8;&#x5BFC;</h2>\n<div class=\"outline-text-2\" id=\"text-orgb51d213\">\n<p>\n2 &#x7C92;&#x5B50;&#x7684;&#x677E;&#x539F;&#x51FD;&#x6570;(&#x6709;&#x81EA;&#x80FD;&#x4FEE;&#x6B63;)\n</p>\n\\begin{align*}\n  G_2(k, \\mathrm{i} \\omega_2) =&amp; \\frac{1}{G_2^0(k,\\mathrm{i}\\omega_2)^{-1} -\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)} \\\\\n                         =&amp; \\frac{1}{\\mathrm{i}\\omega_2 - \\epsilon_{k,2} -\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)}\n\\end{align*}\n<p>\n3 &#x7C92;&#x5B50;&#x7684;&#x677E;&#x539F;&#x51FD;&#x6570;(&#x65E0;&#x76F8;&#x4E92;&#x4F5C;&#x7528;)\n</p>\n\\begin{align*}\n  G_3^0(k,\\mathrm{i}\\omega_3) = \\frac{1}{\\mathrm{i}\\omega_3 - \\epsilon_{k,3}}\n\\end{align*}\n<p>\n&#x4EE3;&#x5165;&#x603B;&#x7684;&#x677E;&#x539F;&#x51FD;&#x6570;\n</p>\n\\begin{align*}\n  R(k , \\mathrm{i}\\omega_n) =&amp; \\frac{1}{\\beta}\\sum_{\\omega_2} G_3(k,\\mathrm{i}(\\omega_2-\\omega_n)) G_2(k,\\mathrm{i}\\omega_2)\\\\\n   =&amp; \\frac{1}{\\beta} \\sum_{\\omega_2} \\frac{1}{\\mathrm{i}(\\omega_2 -\\omega_n) - \\epsilon_{k,3}}\\cdot\n     \\frac{1}{\\mathrm{i}\\omega_2 - \\epsilon_{k,2} -\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)} \\\\\n   =&amp;\\frac{1}{\\beta} \\sum_{\\omega_2}\\left( \\frac{1}{\\mathrm{i}(\\omega_2 -\\omega_n) - \\epsilon_{k,3}} +\n     \\frac{-1}{\\mathrm{i}\\omega_2 - \\epsilon_{k,2} -\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)} \\right)\\cdot\n     \\frac{1}{\\mathrm{i}\\omega_n +\\epsilon_{k,3}-\\epsilon_{k,2}-\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)}\n\\end{align*}\n<p>\n&#x63A5;&#x4E0B;&#x6765;&#x5355;&#x72EC;&#x8BA1;&#x7B97;&#x7B2C;&#x4E00;&#x9879;\n</p>\n\\begin{align*}\n  \\frac{1}{\\beta} \\sum_{\\omega_2} \\frac{1}{\\mathrm{i}(\\omega_2 -\\omega_n) - \\epsilon_{k,3}}\\cdot\n  \\frac{1}{\\mathrm{i}\\omega_n +\\epsilon_{k,3}-\\epsilon_{k,2}-\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)}\n\\end{align*}\n<p>\n&#x5229;&#x7528;&#x73AF;&#x8DEF;&#x79EF;&#x5206;&#x8BA1;&#x7B97;&#x6B64;&#x9879;. &#x79EF;&#x5206;\n</p>\n\\begin{align*}\n  \\oint_{R\\to\\infty}\\frac{1}{\\mathrm{i}(\\omega_2 -\\omega_n) - \\epsilon_{k,3}}\\cdot\n  \\frac{1}{\\mathrm{i}\\omega_n +\\epsilon_{k,3}-\\epsilon_{k,2}-\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)}\n  \\cdot \\frac{1}{e^{\\mathrm{i}\\beta\\omega_2} +1}\\mathrm{d}\\omega_2 = 0\n\\end{align*}\n<p>\n&#x79EF;&#x5206;&#x7684;&#x7559;&#x6570;&#x4E3A;:\n</p>\n\n<p>\n&#x7B2C;&#x4E09;&#x9879;&#x5BF9;&#x5E94;&#x7684;&#x7559;&#x6570;\n</p>\n\\begin{align*}\n  R_3 =   \\frac{1}{\\beta} \\sum_{\\omega_2} \\frac{1}{\\mathrm{i}(\\omega_2 -\\omega_n) - \\epsilon_{k,3}}\\cdot\n  \\frac{1}{\\mathrm{i}\\omega_n +\\epsilon_{k,3}-\\epsilon_{k,2}-\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_2)}\n\\end{align*}\n<p>\n&#x5176;&#x4E2D; \\(\\omega_2 = (2m+1)\\pi/\\beta\\) . &#x5C31;&#x662F;&#x8981;&#x6C42;&#x7684;&#x603B;&#x7684;&#x677E;&#x539F;&#x51FD;&#x6570; \\(R(k,\\mathrm{i}\\omega)\\) .\n</p>\n\n<p>\n&#x7B2C;&#x4E00;&#x9879;&#x5BF9;&#x5E94;&#x7684;&#x7559;&#x6570;\n</p>\n\\begin{align*}\n  R_1 =&amp; \\frac{1}{\\mathrm{i}\\omega_n +\\epsilon_{k,3}-\\epsilon_{k,2}-\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_n +\\epsilon_{k,3})}\n  \\cdot \\frac{1}{e^{\\beta(\\mathrm{i}\\omega_n + \\epsilon_{k,3})} +1} \\\\\n      =&amp; \\frac{ f(\\epsilon_{k,3}) }{\\mathrm{i}\\omega_n +\\epsilon_{k,3}-\\epsilon_{k,2}-\\lambda^2 \\Sigma (k, \\mathrm{i}\\omega_n +\\epsilon_{k,3})}\n\\end{align*}\n</div>\n</div>\n\n<div id=\"outline-container-org9ad8a7d\" class=\"outline-2\">\n<h2 id=\"org9ad8a7d\">&#x6709;&#x9650;&#x6E29;&#x53CA;&#x96F6;&#x6E29;&#x7684;&#x6700;&#x7EC8;&#x91CD;&#x590D;&#x7ED3;&#x679C;</h2>\n<div class=\"outline-text-2\" id=\"text-org9ad8a7d\">\n</div>\n<div id=\"outline-container-orge412c84\" class=\"outline-3\">\n<h3 id=\"orge412c84\">code</h3>\n<div class=\"outline-text-3\" id=\"text-orge412c84\">\n<p>\n<a href=\"T=0.py\">T=0.py</a>\n</p>\n\n<p>\n<a href=\"T=1.py\">T=1.py</a>\n</p>\n\n<p>\n<a href=\"T=1.py\">T=1.py</a>\n</p>\n<div class=\"org-src-container\">\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> integrate</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy.special <span class=\"keyword\">import</span> roots_legendre <span class=\"keyword\">as</span> leg</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gauquad</span><span class=\"params\">(f,a,b,n = <span class=\"number\">50</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">&apos;&apos;&apos;</span><br><span class=\"line\">    &#x5B9A;&#x4E49; Gaussian quadrature &#x79EF;&#x5206;</span><br><span class=\"line\">    &#x51FD;&#x6570; f &#x7684;&#x79EF;&#x5206;&#x533A;&#x95F4;&#x4E3A; [a,b]</span><br><span class=\"line\">    &#x53D6; n &#x4E2A; Legendre &#x7684;&#x6839;</span><br><span class=\"line\">    def Gaussian quadrature integration</span><br><span class=\"line\">    integrate function f from a to b</span><br><span class=\"line\">    take n Legendre roots</span><br><span class=\"line\">    &apos;&apos;&apos;</span></span><br><span class=\"line\">    ft = <span class=\"keyword\">lambda</span> t: f( (b-a)*t/<span class=\"number\">2</span> +(a+b)/<span class=\"number\">2</span> ) * (b-a)/<span class=\"number\">2</span></span><br><span class=\"line\">    x, w = leg(n)</span><br><span class=\"line\">    I = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(n):</span><br><span class=\"line\">\tI = I + w[i]*ft(x[i])</span><br><span class=\"line\">    err = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> I,err</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">twovarplt</span><span class=\"params\">(f,ax,bx,ay,by,Nx=<span class=\"number\">100</span>,Ny=<span class=\"number\">10</span>,gap = <span class=\"number\">2</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">&apos;&apos;&apos;</span><br><span class=\"line\">    &#x4E24;&#x53D8;&#x91CF;&#x753B;&#x56FE;</span><br><span class=\"line\">    f(x,y): &#x8981;&#x7ED8;&#x5236;&#x7684;&#x51FD;&#x6570;</span><br><span class=\"line\">    &#x53D8;&#x91CF; x &#x7684;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x4E3A; [ax,bx], &#x53D6;&#x70B9;&#x7684;&#x4E2A;&#x6570;&#x4E3A; Nx &#x4E2A;</span><br><span class=\"line\">    &#x53D8;&#x91CF; y &#x7684;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x4E3A; [ay,by], &#x753B; Ny &#x6761;&#x7EBF;, &#x6BCF;&#x6761;&#x7EBF;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A; y &#x503C;</span><br><span class=\"line\">    &#x7EBF;&#x4E0E;&#x7EBF;&#x4E4B;&#x95F4;&#x7684;&#x95F4;&#x9694;&#x4E3A; gap</span><br><span class=\"line\">    two variables plot</span><br><span class=\"line\">    plot function f(x,y)</span><br><span class=\"line\">    x takes Nx points from &apos;ax&apos; to &apos;bx&apos;</span><br><span class=\"line\">    each line corresponds a fixd y, y takes Ny points from &apos;ay&apos; to &apos;by&apos;</span><br><span class=\"line\">    the gap between lines is &apos;gap&apos;</span><br><span class=\"line\">    &apos;&apos;&apos;</span></span><br><span class=\"line\">    x = np.linspace(ax,bx,Nx)</span><br><span class=\"line\">    y = np.linspace(ay,by,Ny)</span><br><span class=\"line\">    fx = np.linspace(<span class=\"number\">0</span>,<span class=\"number\">0</span>,Nx)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(Ny):</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(Nx):</span><br><span class=\"line\">\t    print(<span class=\"string\">&apos;&#x7B2C;&apos;</span>,j+<span class=\"number\">1</span>,<span class=\"string\">&apos;&#x6761;&#x7EBF;,&apos;</span>,<span class=\"string\">&apos;&#x7B2C;&apos;</span>,i+<span class=\"number\">1</span>,<span class=\"string\">&apos;&#x4E2A;&#x70B9;,&apos;</span>,<span class=\"string\">&apos;&#x5171;&apos;</span>,Ny,<span class=\"string\">&apos;&#x6761;&#x7EBF;,&apos;</span>,<span class=\"string\">&apos;&#x6BCF;&#x6761;&#x7EBF;&apos;</span>,Nx,<span class=\"string\">&apos;&#x4E2A;&#x70B9;.&apos;</span>)</span><br><span class=\"line\">\t    fx[i] = f(x[i],y[j])</span><br><span class=\"line\">\tplt.plot(x,fx+j*gap )</span><br><span class=\"line\">    <span class=\"comment\">#    plt.plot(x,x*0+y[j],color=(j/Ny,1-j/Ny,j/Ny))</span></span><br><span class=\"line\">    plt.xlabel(<span class=\"string\">r&apos;$\\tilde{\\omega}$&apos;</span>)</span><br><span class=\"line\">    plt.ylabel(<span class=\"string\">r&apos;$I(\\tilde{\\omega})$&apos;</span>)</span><br><span class=\"line\">    plt.yticks([])</span><br><span class=\"line\">    plt.savefig(<span class=\"string\">&apos;./T = 2.jpeg&apos;</span>,writer=<span class=\"string\">&apos;imagemagick&apos;</span>)</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">f</span><span class=\"params\">(p,m,T)</span>:</span>   <span class=\"comment\"># Fermi distribution function</span></span><br><span class=\"line\">    f = <span class=\"number\">1</span>/(np.exp((p**<span class=\"number\">2</span>-m)/T)+<span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">theta</span><span class=\"params\">(x)</span>:</span>   <span class=\"comment\"># Heaviside theta function</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> x&gt;=<span class=\"number\">0</span>:</span><br><span class=\"line\">\tf = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">\tf = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> f</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delta</span><span class=\"params\">(x,b = <span class=\"number\">1e-2</span>)</span>:</span>  <span class=\"comment\"># Dirac delta function</span></span><br><span class=\"line\">    b = <span class=\"number\">1e-2</span></span><br><span class=\"line\">    f = b/(b**<span class=\"number\">2</span> + x**<span class=\"number\">2</span>)/np.pi</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f</span><br><span class=\"line\"></span><br><span class=\"line\">T = <span class=\"number\">2</span>  <span class=\"comment\"># Temperature</span></span><br><span class=\"line\">m = <span class=\"number\">1</span>   <span class=\"comment\"># Chemical potential mu</span></span><br><span class=\"line\">up = <span class=\"number\">10</span> <span class=\"comment\"># Integration cut off of </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">A</span><span class=\"params\">(o,d,k,p)</span>:</span> <span class=\"comment\"># the unintegrated Imaginary part of self-energy</span></span><br><span class=\"line\">    x1 = o-d+p**<span class=\"number\">2</span>/<span class=\"number\">2</span>+k**<span class=\"number\">2</span>/<span class=\"number\">2</span>-p*k</span><br><span class=\"line\">    x2 = o-d+p**<span class=\"number\">2</span>/<span class=\"number\">2</span>+k**<span class=\"number\">2</span>/<span class=\"number\">2</span>+p*k</span><br><span class=\"line\">    <span class=\"keyword\">if</span> x1&gt;<span class=\"number\">0</span> <span class=\"keyword\">or</span> x2&lt;<span class=\"number\">0</span>:</span><br><span class=\"line\">\tA = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">\tA = np.pi*p/k*f(p,m,T)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> A</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">AA</span><span class=\"params\">(o,d,k)</span>:</span>  <span class=\"comment\"># the integrated Imaginary part of self-energy</span></span><br><span class=\"line\">    AA, err = gauquad(<span class=\"keyword\">lambda</span> p:A(o,d,k,p),<span class=\"number\">0</span>,up)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> AA</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">s</span><span class=\"params\">(o,d,k,p)</span>:</span> <span class=\"comment\"># the unintegrated Real part of self-energy</span></span><br><span class=\"line\">    s = f(p,m,T)*p/k*( np.log( np.abs(o-d + (k+p)**<span class=\"number\">2</span>/<span class=\"number\">2</span>) ) - np.log( np.abs(o-d + (k-p)**<span class=\"number\">2</span>/<span class=\"number\">2</span>) ) )</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">S</span><span class=\"params\">(o,d,k)</span>:</span>   <span class=\"comment\"># the integrated Real part of self-energy</span></span><br><span class=\"line\">    S,err = gauquad(<span class=\"keyword\">lambda</span> p:s(o,d,k,p),<span class=\"number\">0</span>,up)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> S</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">I</span><span class=\"params\">(o,d,k)</span>:</span>   <span class=\"comment\"># the unintegrated spectral function</span></span><br><span class=\"line\">    aa = AA(o,d,k)</span><br><span class=\"line\">    bb = S(o,d,k)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> aa == <span class=\"number\">0</span>:</span><br><span class=\"line\">\tI = k**<span class=\"number\">2</span>*f(k,m,T)*delta(o-bb,b=<span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">\tI = k**<span class=\"number\">2</span>*f(k,m,T)*aa/((o-bb)**<span class=\"number\">2</span>+aa**<span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> I</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">II</span><span class=\"params\">(o,d)</span>:</span>    <span class=\"comment\"># the integrated spectral function</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> d&gt;o:</span><br><span class=\"line\">\tII,err = gauquad(<span class=\"keyword\">lambda</span> k:I(o,d,k),<span class=\"number\">0</span>,up,n = <span class=\"number\">100</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">\tII, err = integrate.quad(<span class=\"keyword\">lambda</span> k:I(o,d,k),<span class=\"number\">0</span>,up,epsabs=<span class=\"number\">1.49e-2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> II</span><br><span class=\"line\"></span><br><span class=\"line\">twovarplt(II,-<span class=\"number\">2</span>,<span class=\"number\">2</span>,-<span class=\"number\">8</span>,<span class=\"number\">8</span>,Nx = <span class=\"number\">1000</span>,Ny=<span class=\"number\">33</span>,gap=<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#twovarplt(lambda k ,o:S(o,0,k),0,10,0.1,2,Nx = 100,Ny = 25,gap=0)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&apos;&apos;&apos;</span><br><span class=\"line\">def A(o,d,k,x):</span><br><span class=\"line\">    g = o-d+k**2/2</span><br><span class=\"line\">    r1 = k*x + np.sqrt( k**2*x**2 -2*g )</span><br><span class=\"line\">    r2 = k*x - np.sqrt( k**2*x**2 -2*g )</span><br><span class=\"line\">    A = theta(-g)*theta(1+2*g-2*k*x)*r1**2*f(r1,m,T)</span><br><span class=\"line\">    A = A+ theta(g)*theta(k*x-np.sqrt(2*g))*theta(x) * ( theta(1+2*g-2*k*x)*r1**2*f(r1,m,T) + r2**2*f(r2,m,T))</span><br><span class=\"line\">    A = A/(r1-r2)</span><br><span class=\"line\">    return A</span><br><span class=\"line\">def AA(o,d,k):</span><br><span class=\"line\">    AA, err = gauquad(lambda x:A(o,d,k,x),-1,1)</span><br><span class=\"line\">    AA = np.nan_to_num(AA)</span><br><span class=\"line\">    AA = np.pi*AA</span><br><span class=\"line\">    return AA</span><br><span class=\"line\">&apos;&apos;&apos;</span></span><br><span class=\"line\"><span class=\"string\">&apos;&apos;&apos;</span><br><span class=\"line\">    n = 500</span><br><span class=\"line\">    k = np.linspace(1e-5,up,n)</span><br><span class=\"line\">    for i in range(n):</span><br><span class=\"line\">\tdd = np.abs(o - S(o,d,k[i]))</span><br><span class=\"line\">    #    print(dd)</span><br><span class=\"line\">\tif dd&lt;1e-1:</span><br><span class=\"line\">\t    ko = k[i]</span><br><span class=\"line\">\t    break</span><br><span class=\"line\">\telse:</span><br><span class=\"line\">\t    ko = 0</span><br><span class=\"line\">    II = ko**2*f(ko,m,T)</span><br><span class=\"line\">    return II</span><br><span class=\"line\">&apos;&apos;&apos;</span></span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</div>\n<div id=\"outline-container-org0cc2d2b\" class=\"outline-3\">\n<h3 id=\"org0cc2d2b\">&#x7ED3;&#x679C;</h3>\n<div class=\"outline-text-3\" id=\"text-org0cc2d2b\">\n\n<div class=\"figure\">\n<p><img src=\"T=0.png\">\n</p>\n</div>\n\n\n<div class=\"figure\">\n<p><img src=\"T=1.png\">\n</p>\n</div>\n\n\n<div class=\"figure\">\n<p><img src=\"T=2.png\">\n</p>\n</div>\n\n<p>\n<a href=\"T=0.eps\">T=0.eps</a>\n</p>\n\n<p>\n<a href=\"T=1.eps\">T=1.eps</a>\n</p>\n\n<p>\n<a href=\"T=2.eps\">T=2.eps</a>\n</p>\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-orgf135b73\" class=\"outline-2\">\n<h2 id=\"orgf135b73\">Supplementary</h2>\n<div class=\"outline-text-2\" id=\"text-orgf135b73\">\n<div class=\"org-src-container\">\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">delta = <span class=\"number\">.5</span></span><br><span class=\"line\">N = <span class=\"number\">100</span></span><br><span class=\"line\">o = np.linspace(-<span class=\"number\">2</span>, <span class=\"number\">2</span>, N)</span><br><span class=\"line\">q = np.linspace(-<span class=\"number\">2</span>, <span class=\"number\">2</span>, N)</span><br><span class=\"line\">fig, ax = plt.subplots()</span><br><span class=\"line\"><span class=\"comment\">#line = ax.plot(o,q)</span></span><br><span class=\"line\"><span class=\"comment\">#ax3 = fig.add_axes([0.1, 0.1, 0.2, 0.2])</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ax.plot(o,o*0+1)</span></span><br><span class=\"line\"><span class=\"comment\">#ax.plot(o,o*0)</span></span><br><span class=\"line\">ax.plot(o*<span class=\"number\">0</span>+delta,o, color = <span class=\"string\">&apos;green&apos;</span>)</span><br><span class=\"line\">ax.plot(o*<span class=\"number\">0</span>+delta-<span class=\"number\">.5</span>,o, color = <span class=\"string\">&apos;gray&apos;</span>, linestyle = <span class=\"string\">&apos;--&apos;</span>)</span><br><span class=\"line\">ax.plot(delta - q**<span class=\"number\">2</span>/<span class=\"number\">2</span>, q, <span class=\"string\">&apos;r&apos;</span>, label = <span class=\"string\">r&apos;$\\~\\omega = \\~\\delta - \\frac{\\~q^2}{2}$&apos;</span>)</span><br><span class=\"line\">ax.plot(delta - (q-<span class=\"number\">1</span>)**<span class=\"number\">2</span>/<span class=\"number\">2</span>, q, color = <span class=\"string\">&apos;blue&apos;</span>, label = <span class=\"string\">r&apos;$\\~\\omega = \\~\\delta - \\frac{(\\~q-1)^2}{2}$&apos;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">ax.text(-<span class=\"number\">1.2</span>, <span class=\"number\">.5</span>, <span class=\"string\">r&apos;$r_1,r_2\\notin [0,1]$&apos;</span>, {<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.text(<span class=\"number\">.05</span>, <span class=\"number\">.95</span>, <span class=\"string\">r&apos;$r_2\\in [0,1]$&apos;</span>, {<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.text(<span class=\"number\">.07</span>, <span class=\"number\">.05</span>, <span class=\"string\">r&apos;$r_1\\in [0,1]$&apos;</span>, {<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.text(<span class=\"number\">1</span>, <span class=\"number\">.5</span>, <span class=\"string\">r&apos;no root&apos;</span>, {<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\"></span><br><span class=\"line\">ax.arrow(<span class=\"number\">1</span>, <span class=\"number\">.25</span>, -<span class=\"number\">.55</span>, <span class=\"number\">.25</span>, width = <span class=\"number\">.01</span>)</span><br><span class=\"line\">ax.text(<span class=\"number\">1</span>, <span class=\"number\">.25</span>, <span class=\"string\">r&apos;$r_1,r_2\\in [0,1]$&apos;</span>, {<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ax.set_xlim(0,4*np.pi)</span></span><br><span class=\"line\">ax.set_xlim(-<span class=\"number\">2</span>,<span class=\"number\">2</span>)</span><br><span class=\"line\">ax.set_ylim(<span class=\"number\">0</span>,<span class=\"number\">1</span>)</span><br><span class=\"line\">ax.set_xticks([-<span class=\"number\">2</span>, delta-<span class=\"number\">.5</span>, delta, <span class=\"number\">2</span>])</span><br><span class=\"line\">ax.set_yticks([<span class=\"number\">0</span>,<span class=\"number\">1</span>],)</span><br><span class=\"line\">ax.set_xticklabels([<span class=\"string\">&apos;$-2$&apos;</span>, <span class=\"string\">&apos;$\\~\\delta-1/2$&apos;</span>, <span class=\"string\">&apos;$\\~\\delta$&apos;</span>, <span class=\"string\">&apos;$2$&apos;</span>],{<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.set_yticklabels([<span class=\"number\">0</span>,<span class=\"number\">1</span>],{<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.set_xlabel(<span class=\"string\">&apos;$\\~\\omega$&apos;</span>,{<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.set_ylabel(<span class=\"string\">&apos;$\\~q$&apos;</span>,{<span class=\"string\">&apos;fontsize&apos;</span>:<span class=\"number\">20</span>})</span><br><span class=\"line\">ax.legend(fontsize = <span class=\"number\">20</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</div>\n\n\n\n<div id=\"outline-container-org1b2d683\" class=\"outline-2\">\n<h2 id=\"org1b2d683\">&#x53C2;&#x8003;&#x6587;&#x732E;</h2>\n<div class=\"outline-text-2\" id=\"text-org1b2d683\">\n<p>\nJunjun Xu, Qiang Gu, and Erich J. Mueller Phys. Rev. A 88, 023604 (2013)\n</p>\n</div>\n</div>\n</div>\n"}
